@using HandMadeCakes.Dto
@model CakeCreateDto

<div class="container mt-5">
    <form method="post" asp-action="Register" asp-controller="Cake" enctype="multipart/form-data" novalidate>
        <h2 class="mb-4 text-center">Register a New Cake</h2>

        <div class="text-center mb-4">
            <label for="ImageFile" class="d-inline-block position-relative" style="cursor:pointer;">
                <img id="img" src="/imagem/placeholder.png" alt="Cake Image Preview" class="rounded-4 shadow-sm" style="width:180px; height:240px; object-fit:cover; border: 2px dashed #ddd;" />
                <div class="position-absolute top-50 start-50 translate-middle text-muted fw-semibold" style="pointer-events:none;">
                    Click to upload image
                </div>
            </label>
            <input type="file" id="ImageFile" name="foto" class="form-control d-none" accept="image/*" />
        </div>

        <div class="mb-3">
            <label asp-for="Flavor" class="form-label">Flavor</label>
            <input asp-for="Flavor" class="form-control shadow-none" placeholder="Enter the cake flavor" autofocus />
            <span class="text-danger" asp-validation-for="Flavor"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Description" class="form-label">Description</label>
            <textarea asp-for="Description" class="form-control shadow-none" rows="4" placeholder="Describe your cake..."></textarea>
            <span class="text-danger" asp-validation-for="Description"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Price" class="form-label">Price ($)</label>
            <input type="number" min="1" step="0.01" asp-for="Price" class="form-control shadow-none" placeholder="Set the price" />
            <span class="text-danger" asp-validation-for="Price"></span>
        </div>

        <div class="d-flex gap-3 justify-content-center mt-4">
            <button type="submit" class="btn btn-success px-4 rounded-pill">
                <i class="bi bi-plus-circle me-2"></i> Register
            </button>
            <a asp-controller="Home" asp-action="Index" class="btn btn-secondary px-4 rounded-pill">
                <i class="bi bi-arrow-left-circle me-2"></i> Back
            </a>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        const inputFile = document.querySelector("#ImageFile");
        const imgPreview = document.querySelector("#img");
        const uploadLabel = imgPreview.nextElementSibling;

        inputFile.addEventListener("change", function (e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    imgPreview.src = e.target.result;
                    if(uploadLabel) uploadLabel.style.display = 'none';
                };
                reader.readAsDataURL(file);
            } else {
                imgPreview.src = "/imagem/placeholder.png";
                if(uploadLabel) uploadLabel.style.display = 'block';
            }
        });
    </script>
}
